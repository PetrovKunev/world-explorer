# Поправка на проблема с координатите

## Проблем
При създаване на дестинации координатите се променяха при запазване в базата данни поради неправилно дефинирани типове данни.

## Причина
В SQL схемата координатите бяха дефинирани като:
- `latitude DECIMAL(10, 8)` - само 2 цифри преди десетичната запетая
- `longitude DECIMAL(11, 8)` - само 3 цифри преди десетичната запетая

Това беше проблем, защото:
- Latitude може да бъде от -90 до +90 (трябват 2 цифри преди десетичната запетая)
- Longitude може да бъде от -180 до +180 (трябват 3 цифри преди десетичната запетая)

Когато JavaScript `number` се конвертира в PostgreSQL `DECIMAL` с ограничения, координатите се закръгляха.

## Решение

### 1. Обновяване на SQL схемата
Променени са типовете данни на:
- `latitude DECIMAL(11, 8)` - 3 цифри преди десетичната запетая
- `longitude DECIMAL(12, 8)` - 4 цифри преди десетичната запетая

### 2. Файлове, които са променени
- `database/schema.sql`
- `database/create-table.sql`
- `prisma/schema.prisma`

### 3. Обновяване на съществуващата база данни
Изпълнете SQL скрипта `database/update-coordinates.sql` в Supabase SQL Editor:

```sql
-- Обновяване на типовете данни за координатите
ALTER TABLE destinations 
ALTER COLUMN latitude TYPE DECIMAL(11, 8),
ALTER COLUMN longitude TYPE DECIMAL(12, 8);
```

### 4. Подобрено логване
Добавено е по-детайлно логване в:
- `components/MapComponent.tsx` - за проследяване на координатите при кликване
- `hooks/useDestinations.ts` - за проследяване на координатите при запазване

## Тестване
След прилагане на поправките:
1. Кликнете върху картата за да създадете нова дестинация
2. Проверете конзолата за логовете на координатите
3. Проверете дали координатите в базата данни съвпадат с тези от кликването

## Забележки
- Ако имате съществуващи дестинации с закръглени координати, те ще останат със старите стойности
- Новите дестинации ще се запазват с правилната точност
- За да поправите съществуващите дестинации, трябва да ги изтриете и създадете отново 